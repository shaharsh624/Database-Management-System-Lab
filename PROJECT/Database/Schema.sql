SHOW DATABASES;
CREATE DATABASE SUPERMART;
DROP DATABASE SUPERMART;
USE SUPERMART;
SHOW TABLES;


# Credentials
CREATE TABLE CREDENTIALS (
    USERNAME VARCHAR(20) PRIMARY KEY NOT NULL,
    PASSWORD VARCHAR(100) NOT NULL
);

INSERT INTO CREDENTIALS VALUES ('ADMIN', '123');
INSERT INTO CREDENTIALS VALUES ('USER1', 'USER1');
INSERT INTO CREDENTIALS VALUES ('USER2', 'USER2');
INSERT INTO CREDENTIALS VALUES ('USER3', 'USER3');
INSERT INTO CREDENTIALS VALUES ('USER4', 'USER4');
INSERT INTO CREDENTIALS VALUES ('USER5', 'USER5');

SELECT * FROM CREDENTIALS;


# Entities
CREATE TABLE CUSTOMER (
    C_ID VARCHAR(10) PRIMARY KEY,
    C_NAME VARCHAR(40),
    C_MOBILE VARCHAR(10),
    CONSTRAINT CHECK_PHONE CHECK (C_MOBILE REGEXP '^[0-9]{10}$')
);

CREATE TABLE CATEGORY (
    CATEGORY_ID VARCHAR(20) PRIMARY KEY,
    CATEGORY_NAME VARCHAR(20)
);

CREATE TABLE PRODUCT (
    PRODUCT_ID VARCHAR(10) PRIMARY KEY,
    PRODUCT_NAME VARCHAR(40),
    CATEGORY_ID VARCHAR(20),
    COST_PRICE DECIMAL(10,2),
    SELLING_PRICE DECIMAL(10,2),
    STOCK INTEGER,
    CONSTRAINT CHECK_STOCK CHECK (STOCK >= 0),
    FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY(CATEGORY_ID)
);

CREATE TABLE EMPLOYEE (
    EMP_ID VARCHAR(10) PRIMARY KEY,
    FIRST_NAME VARCHAR(15),
    LAST_NAME VARCHAR(15),
    EMP_GENDER ENUM('MALE', 'FEMALE'),
    EMP_SALARY DECIMAL(10,2)
);

CREATE TABLE ORDERS (
    ORDER_ID VARCHAR(10) PRIMARY KEY,
    CUSTOMER_ID VARCHAR(10),
    AMOUNT DECIMAL(10,2),
    ORDER_DATE DATE,
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(C_ID)
);

CREATE TABLE ORDER_ITEM (
    ORDER_ID VARCHAR(10),
    PRODUCT_ID VARCHAR(10),
    QUANTITY INTEGER,
    PRIMARY KEY (ORDER_ID, PRODUCT_ID),
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID),
    FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID)
);

CREATE TABLE PAYMENT (
    PAY_ID VARCHAR(10) PRIMARY KEY,
    ORDER_ID VARCHAR(10),
    PAY_MODE ENUM('CASH', 'UPI', 'CARD'),
    AMOUNT DECIMAL(10,2),
    PAY_DATE TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID)
);

CREATE TABLE SALES (
    PRODUCT_ID VARCHAR(10),
    QUANTITY_SOLD INTEGER,
    PROFIT DECIMAL(10,2),
    FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCT(PRODUCT_ID)
);

CREATE TABLE EMPLOYEE_MOBILE (
    EMP_ID VARCHAR(10),
    EMP_MOBILE VARCHAR(10),
    PRIMARY KEY (EMP_ID, EMP_MOBILE),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID)
);

CREATE TABLE EMPLOYEE_ORDER (
    EMP_ID VARCHAR(10),
    ORDER_ID VARCHAR(10),
    PRIMARY KEY (EMP_ID, ORDER_ID),
    FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE(EMP_ID),
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS(ORDER_ID)
);


CREATE INDEX IDX_CATEGORY_ID ON CATEGORY(CATEGORY_ID);
CREATE INDEX IDX_ORDER_ID ON ORDER_ITEM(ORDER_ID);
CREATE INDEX IDX_PRODUCT_ID ON ORDER_ITEM(PRODUCT_ID);


INSERT INTO CUSTOMER VALUES ('C001', 'RAJESH KUMAR', 9876543210);
INSERT INTO CUSTOMER VALUES ('C002', 'SONIA GUPTA', 9812345678);
INSERT INTO CUSTOMER VALUES ('C003', 'NEHA SHARMA', 9810987654);
INSERT INTO CUSTOMER VALUES ('C004', 'AYUSH PATEL', 6587541232);

INSERT INTO CATEGORY VALUES('C101','BAKERY');
INSERT INTO CATEGORY VALUES('C102','BEVERAGES');
INSERT INTO CATEGORY VALUES('C103','DAIRY');
INSERT INTO CATEGORY VALUES('C104','GROCERY');
INSERT INTO CATEGORY VALUES('C105','PRODUCE');
INSERT INTO CATEGORY VALUES('C106','CEREALS');
INSERT INTO CATEGORY VALUES('C107','SNACKS');
INSERT INTO CATEGORY VALUES('C108','HOUSEHOLD ITEMS');
INSERT INTO CATEGORY VALUES('C109','BEAUTY');

INSERT INTO PRODUCT VALUES('P101','OATS', 'C106',150,200,89);
INSERT INTO PRODUCT VALUES('P102','MILK', 'C103',45,50,157);
INSERT INTO PRODUCT VALUES('P103','KETCHUP', 'C104',90,100,50);
INSERT INTO PRODUCT VALUES('P104','RICE', 'C106',500,550,26);
INSERT INTO PRODUCT VALUES('P105','BANANA', 'C105',80,100,69);
INSERT INTO PRODUCT VALUES('P106','COKE', 'C102',100,125,46);
INSERT INTO PRODUCT VALUES('P107','HAIR OIL', 'C109',80,85,72);
INSERT INTO PRODUCT VALUES('P108','RICE', 'C101', 350, 400, 100);
INSERT INTO PRODUCT VALUES('P109','BREAD', 'C102', 30, 40, 200);
INSERT INTO PRODUCT VALUES('P110','LIPSTICK', 'C103', 250, 350, 50);

INSERT INTO ORDERS VALUES ('O001', 'C004', 4500, '2022-02-23');
INSERT INTO ORDERS VALUES ('O002', 'C002', 3200, '2023-03-15');
INSERT INTO ORDERS VALUES ('O003', 'C001', 1200, '2022-01-08');
INSERT INTO ORDERS VALUES ('O004', 'C003', 1200, '2022-06-11');

INSERT INTO ORDER_ITEM VALUES ('O001', 'P101', 5);
INSERT INTO ORDER_ITEM VALUES ('O001', 'P102', 3);
INSERT INTO ORDER_ITEM VALUES ('O002', 'P103', 2);

INSERT INTO PAYMENT VALUES ('P001', 'O001', 'UPI', 4500, '2022-03-14');
INSERT INTO PAYMENT VALUES ('P002', 'O002', 'CARD', 3200, '2022-03-15');
INSERT INTO PAYMENT VALUES ('P003', 'O003', 'CASH', 1200, '2022-03-15');

INSERT INTO SALES VALUES ('P101', 15, 5000);
INSERT INTO SALES VALUES ('P102', 10, 300);
INSERT INTO SALES VALUES ('P103', 5, 500);

INSERT INTO EMPLOYEE VALUES ('E001', 'SURESH', 'KUMAR', 'MALE', 30000);
INSERT INTO EMPLOYEE VALUES ('E002', 'RENU', 'SINGH', 'FEMALE', 25000);
INSERT INTO EMPLOYEE VALUES ('E003', 'ANIL', 'VERMA', 'MALE', 28000);

INSERT INTO EMPLOYEE_MOBILE VALUES ('E001', 9879654218);
INSERT INTO EMPLOYEE_MOBILE VALUES ('E002', 7845321975);
INSERT INTO EMPLOYEE_MOBILE VALUES ('E003', 6548724387);

INSERT INTO EMPLOYEE_ORDER VALUES ('E001', 'O001');
INSERT INTO EMPLOYEE_ORDER VALUES ('E002', 'O002');
INSERT INTO EMPLOYEE_ORDER VALUES ('E003', 'O003');



# Relational Schema

# CUSTOMER(C_ID, C_NAME, C_MOBILE)
#
# CATEGORY(CATEGORY_ID, CATEGORY_NAME)
#
# PRODUCT(PRODUCT_ID, PRODUCT_NAME, CATEGORY_ID, COST_PRICE, SELLING_PRICE, STOCK)
#
# EMPLOYEE(EMP_ID, FIRST_NAME, LAST_NAME, EMP_GENDER, EMP_SALARY)
#
# ORDERS(ORDER_ID, CUSTOMER_ID, AMOUNT, ORDER_DATE)
#
# ORDER_ITEM(ORSER_ID, PRODUCT_ID, QUANTITY)
#
# PAYMENT(PAY_ID, ORDER_ID, PAY_MODE, AMOUNT, PAY_DATE)
#
# SALES(PRODUCT_ID, QUANTITY_SOLD, PROFIT)
#
# EMPLOYEE_MOBILE(EMP_ID, EMP_MOBILE)
#
# EMPLOYEE_ORDER(EMP_ID, ORDER_ID)



