SHOW DATABASES;
USE DBMS_CE21_G11;

CREATE TABLE DEPT (
	DEPTNO INTEGER PRIMARY KEY,
    DNAME VARCHAR(20),
    LOC VARCHAR(20)
);
DESC DEPT;

CREATE TABLE EMP (
	EMPNO INTEGER PRIMARY KEY,
    EMPNAME VARCHAR(20),
    JOB VARCHAR(20),
    MGR INTEGER,
    HIREDATE DATE,
    SAL INTEGER,
    COMM INTEGER,
    DEPTNO INTEGER,
    FOREIGN KEY(DEPTNO) REFERENCES DEPT(DEPTNO)
);
DESC EMP;

INSERT INTO DEPT VALUES (10, 'ACCOUNTING', 'NEW YORK');
INSERT INTO DEPT VALUES (20, 'RESEARCH', 'DALLAS');
INSERT INTO DEPT VALUES (30, 'SALES', 'CHICAGO');
INSERT INTO DEPT VALUES (40, 'OPERATIONS', 'BOSTON');
SELECT * FROM DEPT;

INSERT INTO EMP VALUES(7369 ,'SMITH','CLERK',7902,'1980-12-17',800,NULL,20);
INSERT INTO EMP VALUES(7499 ,'ALLEN','SALESMAN',7698,'1981-02-20',1600,300,30);
INSERT INTO EMP VALUES(7521 ,'WARD','SALESMAN',7698,' 1981-02-22',1250,500,30);
INSERT INTO EMP VALUES(7566, 'JONES','MANAGER',7839,' 1981-04-02',2975 ,NULL,20);
INSERT INTO EMP VALUES(7654, 'MARTIN','SALESMAN',7698 ,'1981-09-28',1250,1400,30);
INSERT INTO EMP VALUES(7698, 'BLAKE','MANAGER',7839,' 1981-05-01',2850,NULL,30);
INSERT INTO EMP VALUES(7782, 'CLARK','MANAGER',7839 ,'1981-06-09' ,2450 ,NULL,10);
INSERT INTO EMP VALUES(7788, 'SCOTT','ANALYST', 7566 ,'1987-04-19' ,3000 ,NULL,20);
INSERT INTO EMP VALUES(7839, 'KING','PRESIDENT',NULL, '1981-11-17', 5000,NULL,10);
INSERT INTO EMP VALUES(7844, 'TURNER','SALESMAN',7698,'1981-09-08',1500,0,30);
INSERT INTO EMP VALUES(7876, 'ADAMS','CLERK',7788,'1987-05-23',1100 ,NULL,20);
INSERT INTO EMP VALUES(7900, 'JAMES','CLERK',7698, '1981-12-03', 950 ,NULL,30);
INSERT INTO EMP VALUES(7902, 'FORD','ANALYST',7566, '1981-12-03',3000 ,NULL,20);
INSERT INTO EMP VALUES(7934, 'MILLER','CLERK',7782, '1982-01-23',1300 ,NULL,10);
INSERT INTO EMP VALUES(777, 'XYZ',NULL, NULL, '2023-01-01',2850 ,NULL,20);
SELECT * FROM EMP;


#1
SELECT * FROM EMP WHERE SAL > 
(SELECT SAL FROM EMP WHERE EMPNAME = "BLAKE");

#2
SELECT EMPNAME FROM EMP WHERE JOB = 
(SELECT JOB FROM EMP WHERE EMPNAME = "ALLEN");

#3
SELECT EMPNAME FROM EMP WHERE SAL IN
(SELECT SAL FROM EMP WHERE EMPNAME IN ('FORD', 'SMITH')) 
ORDER BY EMPNAME DESC;

#4
SELECT EMPNAME FROM EMP WHERE SAL >
(SELECT SAL FROM EMP WHERE EMPNAME = "ALLEN")
OR JOB = (SELECT JOB FROM EMP WHERE EMPNAME = "MILLER");

#5
SELECT EMPNAME FROM EMP WHERE SAL =
(SELECT MAX(SAL) FROM EMP WHERE DEPTNO IN
(SELECT DEPTNO FROM DEPT WHERE DNAME = "SALES")
AND DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME = 'SALES')
);

#6
SELECT EMPNAME FROM EMP WHERE HIREDATE < 
(SELECT MAX(HIREDATE) FROM EMP WHERE MGR IN
(SELECT EMPNO FROM EMP WHERE EMPNAME = "KING"));

#7
SELECT EMPNAME, DEPTNO FROM EMP,
(SELECT MAX(SAL) AS M, DEPTNO AS D FROM EMP GROUP BY DEPTNO) as MD
WHERE SAL = MD.M AND DEPTNO = MD.D;

#8
SELECT * FROM EMP WHERE SAL =
(SELECT (MAX(SAL) + MIN(SAL)) / 2 FROM EMP);

#9
SELECT * FROM EMP AS E WHERE HIREDATE IN
(SELECT HIREDATE FROM EMP WHERE E.EMPNO <> EMPNO);

#10
SELECT EMPNAME FROM EMP E WHERE HIREDATE < 
(SELECT HIREDATE FROM EMP WHERE EMPNO = E.MGR);

